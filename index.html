<html>
	<head>
		<title>Mars Solar Time Calculation</title>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
	 <script>
	 	function cos(deg) {
                return Math.cos(deg * Math.PI / 180);
            }
            function sin(deg) {
                return Math.sin(deg * Math.PI / 180);
            }
	 	function getMarsTime(){
	 		var d = new Date();
	 		var millis = d.getTime();
	 		var jdut = 2440587.5 + (millis / (8.64E7));
	 		var taiMinusUtc = 37; //TO-DO: changeable
	 		var ttMinusUtc = taiMinusUtc + 32.184; //TO-DO: make it work prior to Jan 1972
	 		var jdtt = jdut + (ttMinusUtc/86400)
	 		var timeOffsetJ2000 = jdtt - 2451545.0;
	 		var meanAnomaly = 19.3871 + (0.52402073 * timeOffsetJ2000);
	 		var angleFMS = 270.3871 + (0.524038496* timeOffsetJ2000);
	 		var pbs = 0.0071 * cos((0.985626 * j2000 /  2.2353) +  49.409) +
                    0.0057 * cos((0.985626 * j2000 /  2.7543) + 168.173) +
                    0.0039 * cos((0.985626 * j2000 /  1.1177) + 191.837) +
                    0.0037 * cos((0.985626 * j2000 / 15.7866) +  21.736) +
                    0.0021 * cos((0.985626 * j2000 /  2.1354) +  15.704) +
                    0.0020 * cos((0.985626 * j2000 /  2.4694) +  95.528) +
                    0.0018 * cos((0.985626 * j2000 / 32.8493) +  49.095);
            var equationOfCenter =  (10.691 +( 3.0 * 10E-7 * timeOffsetJ2000))* sin(meanAnomaly) + 0.623* sin(2*meanAnomaly) + 0.050* sin(3*meanAnomaly) + 0.005* sin(4*meanAnomaly) + 0.0005* sin(5*meanAnomaly) + pbs;
            var Ls = angleFMS + equationOfCenter;
            var equationOfTime =  (2.861* sin (2*Ls)) - (0.071* sin (4*Ls)) + (0.002* sin(6*Ls)) - equationOfCenter;
            var withoutModMTC =  24 * ( ((jdtt - 2451549.5) / 1.0274912517) + 44796.0 - 0.0009626 ) ;
            var mtc = withoutModMTC % 24;
            var lmst = mtc; // - degree*(1/15)
            var ltst = lmst + (equationOfTime/15);
            var subsolarLongitude = (mtc + equationOfTime)*15 + 180;

             $(".millis").text(add_commas(millis));
             $(".jdut").text(add_commas(jdut.toFixed(5)));
             $(".ttMinusUtc").text(ttMinusUtc.toFixed(5));


	 	}

	 </script>
	</head>
	<script type="text/javascript"></script>
	<link href="http://fonts.googleapis.com/css?family=Open+Sans:300italic,700,300,400" rel="stylesheet" type="text/css">
	<style type="text/css"></style>
	<body onload="getMarsTime()">
	<div class = "container">
		<div class = "intro">
			
		</div>
		<div class="values">
			millis = <span class='millis'></span>&deg;
		</div>
		
	</div>
	 
	</body>
</html>